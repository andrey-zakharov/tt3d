=Networking=

==Low network layer==
http://yuml.me/32c92f29?.png

{{{
[protobuf::RpcController]^[RpcController]
[RpcController]^[Connection]
[protobuf::RpcChannel]^[Connection{bg:white}]
[Connection]^[ProtobufConnection]
[ProtobufConnection]^[ClientConnection]
[<<noncopyable>>]^-.-[RawConnection]
[RawConnection]^[RawConnectionImpl]
[RawConnectionImpl]uses -.->[Decoder]
[RawConnectionImpl]^[RawProtobufConnection]
[RawProtobufConnection]uses -.->[ProtobufDecoder]
[Connection]<>1-1[RawConnection]
[Server{bg:blue]<>-*[Connection]
[Server]-.-[ProtobufConnection]
[Client{bg:red}]<>-1[Connection]
[Client]-.-[ClientConnection]
[Decoder]-.-[ProtobufDecoder]
}}}
==High level layer==
===Server side===
Yellow boxes are ready classes.
Orange - RPC layer

http://yuml.me/6cb3b8ba?.png
{{{
# Server side. Simplified
# yellow - ready to use
# orange - RPC layer
# green - engine layer
[Server{bg:blue}]<>-1[ConnectionTemplate{bg:yellow}]
[ConnectionTemplate]<>-*[RpcService{bg:yellow}]
[RpcService]^[<<RpcService>>;Clients{bg:orange}]
[RpcService]^[<<RpcService>>;Landscape{bg:orange}]
[RpcService]^[<<RpcService>>;Vehicles{bg:orange}]
[RpcService]^[<<RpcService>>;Tracks{bg:orange}]
[RpcService]^[<<RpcService>>;Economy{bg:orange}]
[<<RpcService>>;Clients]<-.->[<<manager>>;Clients{bg:green}]
[<<RpcService>>;Landscape]<-.->[<<manager>>;Landscape{bg:green}]
[<<RpcService>>;Vehicles]<-.->[<<manager>>;Vehicles{bg:green}]
[<<RpcService>>;Tracks]<-.->[<<manager>>;Tracks{bg:green}]
[<<RpcService>>;Economy]<-.->[<<manager>>;Economy{bg:green}]
[<<manager>>;Clients]--buy land>[<<manager>>;Landscape]
[<<manager>>;Clients]<-->[<<manager>>;Vehicles]
[<<manager>>;Tracks]<build--owned by>[<<manager>>;Clients]
[<<manager>>;Landscape]<lay on--weighed down by>[<<manager>>;Tracks]
[<<manager>>;Tracks]<drive on-used for>[<<manager>>;Vehicles]
#[<<manager>>;Landscape]<-->[Physics]
[<<manager>>;Vehicles]<-->[Physics]
[<<manager>>;Tracks]<-->[Physics]
[Physics]^-.->[<<implementation>>;PhysicsEngine]
}}}

==Draft==
http://img687.imageshack.us/img687/3586/test2pr.png